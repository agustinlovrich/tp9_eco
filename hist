###para borrar los comandos u objetos que puedan existir almacenado en la memoria
rm(list=ls())

###elegir directorio de trabajo
###instalar libreria si se requiere
#install.packages("ggplot2") 

## Paquetes
library(ggplot2)
library(gridExtra)

## Importar CSV
# modificarlo según la ruta de la pc donde estén trabajando
datos <- read.csv("C:/Users/agust/Downloads/interacciones_red.csv", stringsAsFactors = FALSE)

### Exploramos característica/estructura del data.frame (nuestros datos)
#head(datos)
#View(datos)

# K_plantas = grado de cada planta (número de visitantes que la visitan)
# (todas las columnas menos la primera, que es el nombre de la planta)
datos$K_plantas <- rowSums(datos[ , -1])

# K_visitnates = grado de cada visitante (número de plantas visitadas)
# lo dejamos como vector aparte, porque sería un error mostrarlo en la tabla (no coinciden filas y columnas)
K_visit <- colSums(datos[ , 2:9])

df_vis <- data.frame(K_visit = K_visit)

# Histogramas bonitos

visitantes <- ggplot(df_vis, aes(x = K_visit)) +
  geom_histogram(
    binwidth = 1,
    colour   = "black",
    fill     = "dodgerblue",
    alpha    = 0.3
  ) +
  theme_classic() +
  labs(
    title = "Distribución de frecuencias de k (visitantes)",
    x     = "k",
    y     = "Frecuencia"
  ) +
  scale_x_continuous(breaks = seq(0, 13, by = 1)) +
  scale_y_continuous(breaks = seq(0, 8,  by = 1))

# plot(visitantes)

plantas <- ggplot(datos, aes(x = K_plantas)) +
  geom_histogram(
    binwidth = 1,
    colour   = "red",
    fill     = "palegreen",
    alpha    = 0.3
  ) +
  theme_classic() +
  labs(
    title = "Distribución de frecuencias de k (plantas)",
    x     = "k",
    y     = "Frecuencia"
  ) +
  scale_x_continuous(breaks = seq(0, 7, by = 1)) +
  scale_y_continuous(breaks = seq(0, 7, by = 1))

# plot(plantas)


# ambos plots en uno solo
grid.arrange(plantas, visitantes, ncol = 2)
